
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../flute_tutorial/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.18">
    
    
      
        <title>Fixed-point numbers - flute documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.66ac8b77.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#fixed-point-numbers" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="flute documentation" class="md-header__button md-logo" aria-label="flute documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            flute documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Fixed-point numbers
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8v2m9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1 0 1.71-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/RonnaTechnologies/flute" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    RonnaTechnologies/flute
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="flute documentation" class="md-nav__button md-logo" aria-label="flute documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    flute documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/RonnaTechnologies/flute" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    RonnaTechnologies/flute
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About flute
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Fixed-point numbers
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Fixed-point numbers
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-are-fixed-point-numbers" class="md-nav__link">
    <span class="md-ellipsis">
      What are fixed-point numbers?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-use-fixed-point-numbers" class="md-nav__link">
    <span class="md-ellipsis">
      Why use fixed-point numbers?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#q-notation" class="md-nav__link">
    <span class="md-ellipsis">
      \(Q\) notation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#range-of-fixed-point-numbers" class="md-nav__link">
    <span class="md-ellipsis">
      Range of fixed-point numbers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#precision-of-fixed-point-numbers" class="md-nav__link">
    <span class="md-ellipsis">
      Precision of fixed-point numbers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#internal-representation" class="md-nav__link">
    <span class="md-ellipsis">
      Internal representation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#from-and-to-fixed-point" class="md-nav__link">
    <span class="md-ellipsis">
      From and to fixed-point
    </span>
  </a>
  
    <nav class="md-nav" aria-label="From and to fixed-point">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#converting-from-floating-point" class="md-nav__link">
    <span class="md-ellipsis">
      Converting from floating-point
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#converting-to-floating-point" class="md-nav__link">
    <span class="md-ellipsis">
      Converting to floating-point
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#converting-from-and-to-an-integer" class="md-nav__link">
    <span class="md-ellipsis">
      Converting from and to an integer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fixed-point-arithmetic" class="md-nav__link">
    <span class="md-ellipsis">
      Fixed-point arithmetic
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Fixed-point arithmetic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#addition-and-subtraction" class="md-nav__link">
    <span class="md-ellipsis">
      Addition and subtraction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiplication" class="md-nav__link">
    <span class="md-ellipsis">
      Multiplication
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../flute_tutorial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flute Tutorial
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-are-fixed-point-numbers" class="md-nav__link">
    <span class="md-ellipsis">
      What are fixed-point numbers?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#why-use-fixed-point-numbers" class="md-nav__link">
    <span class="md-ellipsis">
      Why use fixed-point numbers?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#q-notation" class="md-nav__link">
    <span class="md-ellipsis">
      \(Q\) notation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#range-of-fixed-point-numbers" class="md-nav__link">
    <span class="md-ellipsis">
      Range of fixed-point numbers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#precision-of-fixed-point-numbers" class="md-nav__link">
    <span class="md-ellipsis">
      Precision of fixed-point numbers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#internal-representation" class="md-nav__link">
    <span class="md-ellipsis">
      Internal representation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#from-and-to-fixed-point" class="md-nav__link">
    <span class="md-ellipsis">
      From and to fixed-point
    </span>
  </a>
  
    <nav class="md-nav" aria-label="From and to fixed-point">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#converting-from-floating-point" class="md-nav__link">
    <span class="md-ellipsis">
      Converting from floating-point
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#converting-to-floating-point" class="md-nav__link">
    <span class="md-ellipsis">
      Converting to floating-point
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#converting-from-and-to-an-integer" class="md-nav__link">
    <span class="md-ellipsis">
      Converting from and to an integer
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fixed-point-arithmetic" class="md-nav__link">
    <span class="md-ellipsis">
      Fixed-point arithmetic
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Fixed-point arithmetic">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#addition-and-subtraction" class="md-nav__link">
    <span class="md-ellipsis">
      Addition and subtraction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiplication" class="md-nav__link">
    <span class="md-ellipsis">
      Multiplication
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="fixed-point-numbers">Fixed-point numbers<a class="headerlink" href="#fixed-point-numbers" title="Permanent link">&para;</a></h1>
<h2 id="what-are-fixed-point-numbers">What are fixed-point numbers?<a class="headerlink" href="#what-are-fixed-point-numbers" title="Permanent link">&para;</a></h2>
<p>In essence, fixed-point numbers are a very simple representation of rational (non-integer) numbers.
The idea is that there is a fixed number of digits representing the fractional part of a number. The same goes for the integer part, so a fixed-point number can be: 12.75, where 12 is the integer part and 75 the fractional part. In this example, if there are always two digits before and after the point, we call that a fixed-point number, at least in base 10.</p>
<h2 id="why-use-fixed-point-numbers">Why use fixed-point numbers?<a class="headerlink" href="#why-use-fixed-point-numbers" title="Permanent link">&para;</a></h2>
<p>Fixed-point numbers are mostly useful in the embedded world, where some micro-controllers don't have a floating point unit (FPU), that is: they don't have the required hardware to perform floating-point operations.
On those micro-controllers, floating-point arithmetic is still possible, but it is very slow.</p>
<p>On the other hand, fixed-point numbers are very simple. Their simplicity is also the reason why they are pretty fast for basic arithmetic operations. They also allow to choose the position of the radix point, which can be very convenient.</p>
<h2 id="q-notation"><span class="arithmatex">\(Q\)</span> notation<a class="headerlink" href="#q-notation" title="Permanent link">&para;</a></h2>
<p>The <span class="arithmatex">\(Q\)</span> notation is often used to represent binary fixed-point numbers. Imagine that we have a 8-bit micro-controller and want to perform some non-integer computations. To that end, we need parameter that goes from <span class="arithmatex">\(0\)</span> to <span class="arithmatex">\(10\)</span>, with a step of <span class="arithmatex">\(0.1\)</span>.</p>
<p>To satisfy those conditions, we need the integer part to go from <span class="arithmatex">\(0\)</span> to, at least, <span class="arithmatex">\(10\)</span>, and the fractional part to have a smallest value lower than 0.1, that is <span class="arithmatex">\(\leq2^{-4}\)</span>, as <span class="arithmatex">\(2^{-4} = 0.0625\)</span>.</p>
<p>The <span class="arithmatex">\(Q\)</span> notation comes in handy, in that it lets use represent such a number as: <span class="arithmatex">\(UQi.f\)</span>, where <span class="arithmatex">\(i\)</span> is the integer part, and <span class="arithmatex">\(f\)</span> the fractional part of the number we wish to represent.
The <span class="arithmatex">\(U\)</span> prefix means that we are dealing with unsigned numbers.
To meet our example's requirements, we need to have a <span class="arithmatex">\(UQ4.4\)</span> number.</p>
<p>Of course, a <span class="arithmatex">\(UQ4.4\)</span> number is stored as a single byte.</p>
<h2 id="range-of-fixed-point-numbers">Range of fixed-point numbers<a class="headerlink" href="#range-of-fixed-point-numbers" title="Permanent link">&para;</a></h2>
<p>One of the most important properties of fixed-point numbers is their range. The minimum value of an unsigned fixed-point number is <span class="arithmatex">\(0\)</span>.
However, the maximum value depends on both its integer part <span class="arithmatex">\(i\)</span>, and its fractional part <span class="arithmatex">\(f\)</span>.
The maximum value corresponding to the integer part is <span class="arithmatex">\(2^i - 1\)</span>, to which we must add the maximum of the fractional part: <span class="arithmatex">\(1 - 2^{-f}\)</span>.
Adding the two values leads to:
$$
\begin{equation}
0 \leq UQi.f \leq 2^i - 2^f.
\end{equation}
$$
For instance, the maximum value of a <span class="arithmatex">\(Q4.4\)</span> number is <span class="arithmatex">\(2^4 - 2^{-4} = 16 - \frac{1}{16} = 15.9375.\)</span></p>
<p>Now, if we consider signed fixed-point numbers, the minimum value becomes <span class="arithmatex">\(-2^{i - 1}\)</span>, which is the same as a regular signed integer.
The maximum value, is <span class="arithmatex">\(2^{i - 1} - 2^{-f}\)</span>.
A signed number's most significant bit holds the sign, so a <span class="arithmatex">\(Q3.4\)</span> fixed-point number requires 8 bits of data<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>.</p>
<p>We can see that, for a signed fixed-point, the following applies:
$$
\begin{equation}
-2^{i - 1} \leq Qi.f \leq 2^{i - 1} - 2^{-f}.
\end{equation}
$$
For instance, a <span class="arithmatex">\(Q3.4\)</span> number goes from <span class="arithmatex">\(-2^2 = -4\)</span> to <span class="arithmatex">\(2^2 - 2^{-4} = 3.9375\)</span>.</p>
<h2 id="precision-of-fixed-point-numbers">Precision of fixed-point numbers<a class="headerlink" href="#precision-of-fixed-point-numbers" title="Permanent link">&para;</a></h2>
<p>The precision of a fixed-point solely defined by its number of fractional bits:
$$
\begin{equation}
\epsilon(Qi.f) = 2^{-f}.
\end{equation}
$$</p>
<h2 id="internal-representation">Internal representation<a class="headerlink" href="#internal-representation" title="Permanent link">&para;</a></h2>
<p>The internal representation of a fixed-point number depends on the number of bits that are necessary to store it.
As an example, a <span class="arithmatex">\(UQ4.4\)</span> requires 8 bits, so a single byte can be used to represent the number.
Similarly, a <span class="arithmatex">\(Q3.4\)</span> number also requires a full byte to be represented, as one extra bit is required to store its sign.
So, basically, to represent a <span class="arithmatex">\(UQi.f\)</span>, <span class="arithmatex">\(i + f\)</span> bits are required, and for a <span class="arithmatex">\(Qi.f\)</span>, <span class="arithmatex">\(i + f + 1\)</span> bits are needed.</p>
<h2 id="from-and-to-fixed-point">From and to fixed-point<a class="headerlink" href="#from-and-to-fixed-point" title="Permanent link">&para;</a></h2>
<p>A fixed-point number is stored as an integer, but it needs to represent an integer and a fractional part.
We know that the fractional part's precision is <span class="arithmatex">\(2^{-f}\)</span>, so it seems quite natural to represent a fixed-point number <span class="arithmatex">\(UQi.f\)</span> as:
$$
\begin{equation}
UQi.f = \frac{N}{2^{-f}} = N \times 2^f,
\end{equation}
$$
where <span class="arithmatex">\(N\)</span> is the numerator of the fractional representation of the fixed-point number.
For instance, a <span class="arithmatex">\(Q3.4\)</span> number that represents the value <span class="arithmatex">\(3.25\)</span> is represented by: <span class="arithmatex">\(N = 3.25 = 3 + 0.25 = 3 + \frac{4}{2^4} = \frac{3 \times 2^4 + 4}{2^4}\)</span>. If we multiply this expression by <span class="arithmatex">\(2^f = 2^4\)</span>, we get <span class="arithmatex">\(N \times 2^4 = 3 \times 2^4 + 4\)</span>. In computer programming, multiplying by <span class="arithmatex">\(2^4\)</span> is the same as shifting 4 bits to the left, i.e.: <span class="arithmatex">\(N \times 2^4 \equiv N \ll 4\)</span>, which leads to the following:
$$
\begin{equation}
    UQi.f = N \ll f.
\end{equation}
$$</p>
<h3 id="converting-from-floating-point">Converting from floating-point<a class="headerlink" href="#converting-from-floating-point" title="Permanent link">&para;</a></h3>
<p>Some constants, like <span class="arithmatex">\(\pi\)</span>, need to be initialized as floating-point numbers, as this is the most intuitive representation. As constants are evaluated at compile-time (at least in C++), it would be very interesting to be able to convert a given constant from its floating-point representation to a fixed-point number.</p>
<p>Let, $F, a floating-point number, its fixed-point representation is given by:
$$
\begin{equation}
UQi.f = F \times 2^f.
\end{equation}
$$
For instance, let's say we need to perform some computations that involve <span class="arithmatex">\(\pi\)</span> on a 8-bit micro-controller.
The integer part of <span class="arithmatex">\(\pi\)</span> is <span class="arithmatex">\(3\)</span>, so we only 2 bits to represent it, which leaves us 6 bits for the fractional part.
If we use a <span class="arithmatex">\(UQ2.6\)</span> number, our approximation of <span class="arithmatex">\(\pi\)</span> will have a precision of <span class="arithmatex">\(2^{-6} = 0.015625\)</span>.
Assuming that is a good enough approximation, we get the following fixed-point internal representation of <span class="arithmatex">\(\pi\)</span>: <span class="arithmatex">\(\lfloor \pi \times 2^6 \rfloor = 201\)</span>.
Since <span class="arithmatex">\(201 = 3 \ times 2^6 + 9\)</span>, the fixed-point number that we get is in fact: <span class="arithmatex">\(3 + \frac{9}{2^6} \approx 3.1406\)</span>.
The same approximation with a <span class="arithmatex">\(UQ4.12\)</span> number gives an internal representation of <span class="arithmatex">\(12,868\)</span>, which represents the number <span class="arithmatex">\(3.1416\)</span>.
Again, same approximation with a <span class="arithmatex">\(UQ12.20\)</span> leads to <span class="arithmatex">\(3,294,198\)</span>, which represents the number <span class="arithmatex">\(\approx 3.141592\)</span>.</p>
<p>None of the above will ever be very close to <span class="arithmatex">\(\pi\)</span>, but they can be very good approximations, and, as we'll see later, they will lead to very fast computations.</p>
<h3 id="converting-to-floating-point">Converting to floating-point<a class="headerlink" href="#converting-to-floating-point" title="Permanent link">&para;</a></h3>
<p>Let's consider the last example of the previous section.
How did we get the approximation of <span class="arithmatex">\(3.141592\)</span> from the internal representation <span class="arithmatex">\(3,294,198\)</span> of our <span class="arithmatex">\(UQ12.20\)</span> number?
The answer is quite simple: instead of multiplying by <span class="arithmatex">\(2^{20}\)</span>, we divided by <span class="arithmatex">\(2^{20}\)</span>.
This leads to:
$$
\begin{equation}
F = UQi.f \times 2^{-f}.
\end{equation}
$$
Let's verify this equation: <span class="arithmatex">\(\frac{3,294,198}{2^20} = \frac{3,294,198}{1,048,576} \approx 3.141592\)</span>.</p>
<h3 id="converting-from-and-to-an-integer">Converting from and to an integer<a class="headerlink" href="#converting-from-and-to-an-integer" title="Permanent link">&para;</a></h3>
<p>The same formulas apply to integer, so equations <span class="arithmatex">\((6)\)</span> and <span class="arithmatex">\((7)\)</span> can be used to retrieve an integer <span class="arithmatex">\(I\)</span> directly by replacing <span class="arithmatex">\(F\)</span> by <span class="arithmatex">\(I\)</span>.</p>
<h2 id="fixed-point-arithmetic">Fixed-point arithmetic<a class="headerlink" href="#fixed-point-arithmetic" title="Permanent link">&para;</a></h2>
<p>One of the main advantages of fixed-point numbers is their ability to perform fast arithmetic operations.
The internal representation of a fixed-point number being an integer, operations are almost as fast as integer operations.</p>
<h3 id="addition-and-subtraction">Addition and subtraction<a class="headerlink" href="#addition-and-subtraction" title="Permanent link">&para;</a></h3>
<p>Things are quite simple for addition and subtraction of fixed-point numbers, as long as they share the same integer and fractional parts.
Let's consider addition of two fixed-point numbers.
We would like to add a <span class="arithmatex">\(Qi_1.f_1\)</span> number to a <span class="arithmatex">\(Qi_2.f_2\)</span> number.
These numbers can be represented by <span class="arithmatex">\(Qi_1.f_1 = N_1 \times 2^{f_1}\)</span> and <span class="arithmatex">\(Qi_2.f_2 = N_2 \times 2^{f_2}\)</span>.
If <span class="arithmatex">\(f_1 = f_2 = f\)</span>, we get immediately:
$$
\begin{equation}
Qi_1.f + Qi_2.f = \left( N_1 + N_2 \right) \times 2^{f}.
\end{equation}
$$
Of course things get a little bit more complicated if <span class="arithmatex">\(f_1 \neq f_2\)</span>.</p>
<p>Another simple case is the addition of a fixed-point number <span class="arithmatex">\(Qi.f\)</span> and an integer <span class="arithmatex">\(I\)</span>:
$$
\begin{equation}
I + Qi.f = N_I \times 2^{f} + Qi.f = \left( N_I + N \right) \times 2^f.
\end{equation}
$$</p>
<p>The subtraction isn't more complex than the addition, as the sign is handled by the underlying integer operation.
Overflow can happen, as it can happen with integer addition and subtraction.</p>
<h3 id="multiplication">Multiplication<a class="headerlink" href="#multiplication" title="Permanent link">&para;</a></h3>
<p>Now, say we want to multiply <span class="arithmatex">\(Qi_1.f_1\)</span> and <span class="arithmatex">\(Qi_2.f_2\)</span>: 
$$
\begin{equation}
Qi_1.f_1 \times Qi_2.f_2 = \left( N_1 \times 2^{f_1} \right) \times \left( N_2 \times 2^{f_2} \right) = N_1\,N_2 \times 2^{f_1 + f_2}.
\end{equation}
$$
Let's call <span class="arithmatex">\(Qi_\times.f_\times\)</span> the result of the previous multiplication.
It leads to:
$$
Qi_\times.f_\times = Qi_1.f_1 \times Qi_2.f_2,
$$
and so:
$$
N_\times 2^{f_\times} = N_1\,N_2 \times 2^{f_1 + f_2},
$$
thus, the internal representation of the multiplication's result is:
$$
\begin{equation}
N_\times = \left( N_1\,N_2 \times 2^{f_1 + f_2} \right) \times 2^{-f_\times}.
\end{equation}
$$
The value of <span class="arithmatex">\(f_\times\)</span> can be anything we want, but great care has to be taken, as <span class="arithmatex">\(N_1\,N_2 \times 2^{f_1 + f_2}\)</span> can lead to integer overflow.</p>
<p>As an example, imagine we want to compute the perimeter of a circle.*
The diameter of the circle is <span class="arithmatex">\(d = 1.75\)</span>, so its perimeter is <span class="arithmatex">\(d \times \pi\)</span>.
We use <span class="arithmatex">\(UQ10.22\)</span> for both numbers, which requires a 32-bit integer internally, so <span class="arithmatex">\(N_d = 1.75 \times 2^{22} = 7,340,032\)</span> and <span class="arithmatex">\(N_\pi = \pi \times 2^{22} \approx 13,176,795\)</span>.
We get <span class="arithmatex">\(N_{d \times \pi} = N_d N_{\pi} \times 2^{f_d + f_{\pi}} = 7,340,032 \times 13,176,795 = 96,718,089,617,408\)</span>.
This intermediate value is a very big number that overflows 32-bit integers by a lot, so it needs to be stored in a temporary 64-bit integer.</p>
<p>Now we want the result to be <span class="arithmatex">\(UQ10.22\)</span> as well, so <span class="arithmatex">\(f_{d \times \pi} = 22\)</span>, which implies that the internal representation of the multiplication is <span class="arithmatex">\(96,718,089,617,408 \times 2^{-22} = 23,059,389\)</span>.
Let's convert that number back to a floating-point: <span class="arithmatex">\(F_{d \times \pi} = 23,059,389 \times 2^{-22} \approx 5.49778688\)</span>.
The actual result is <span class="arithmatex">\(5.49778714\)</span>, so that's not too bad of an approximation.</p>
<p>What we have done is multiply two 32-bit integers, store the result in a 64-bit integer and multiply by <span class="arithmatex">\(2^{-22}\)</span> to get the internal representation of the result.
Multiplying by <span class="arithmatex">\(2^{-22}\)</span> is the same as shifting right by 22 bits (<span class="arithmatex">\(\gg 22\)</span>), which is computationally inexpensive. </p>
<p>Multiplying by an integer <span class="arithmatex">\(I\)</span> is a little bit easier: 
$$
\begin{equation}
Qi_\times.f_\times = I \times Qi.f.
\end{equation}
$$</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>This is the Texas Instruments notation.&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href=".." class="md-footer__link md-footer__link--prev" aria-label="Previous: About flute">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                About flute
              </div>
            </div>
          </a>
        
        
          
          <a href="../flute_tutorial/" class="md-footer__link md-footer__link--next" aria-label="Next: Flute Tutorial">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Flute Tutorial
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "navigation.footer", "navigation.indexes", "navigation.tracking", "toc.follow", "search.suggest", "search.highlight", "content.code.annotate", "content.code.copy", "content.tooltips"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.3220b9d7.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>